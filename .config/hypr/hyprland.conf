## App Fixes ###
#Firefox: (PDF issue): about:config, gfx.canvas.accelerated = false
#Firefox: (Black Flickering? DOesnt seem to work): gfx.webrender.force-disabled = true
#Firefox: (Scaling): about:config, layout.css.devPixelsPerPx 1.5
#Firefox: (Scrolling): about:config, general.autoScroll true, middlemouse.paste false
#Firefox: (Slow Loading) abount:config, browser.cache.disk: false

################
### MONITORS ###
################

#Dual Monitor
monitor=  DP-2, 3840x2160@144, 2560x0, 1, vrr, 0 #2
monitor=  DP-3, 2560x1440@165, 0x0, 1, vrr, 0

#Single Monitor
#monitor=DP-1, 3840x2160@160, 0x0, 1
#monitor=DP-3, 2560x1440@165, 0x0, 1, vrr, 0

workspace=1,monitor:DP-2
workspace=2,monitor:DP-2
workspace=3,monitor:DP-2
workspace=4,monitor:DP-2
workspace=5,monitor:DP-2
workspace=6,monitor:DP-3
workspace=7,monitor:DP-3
workspace=8,monitor:DP-3
workspace=9,monitor:DP-3
workspace=10,monitor:DP-3

#############################
### ENVIRONMENT VARIABLES ###
#############################

#Session setup and gpu acceleration
env = LIBVA_NVIDIA_DRIVER,nvidia
env = LIBVA_DRIVER_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm
env = GDK_BACKEND,wayland,x11
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = NVD_BACKEND,direct
env = ELECTRON_OZONE_PLATFORM_HINT,auto

#Recommended settings 
env = __GL_VRR_ALLOWED,1 # Recommended 0 for some games, setting to 1 breaks them
env = __GL_GSYNC_ALLOWED,1

#Game stuff
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

#Firefox stuff
env = MOZ_ENABLE_WAYLAND,1
env = EGL_PLATFORM,wayland
env = __EGL_VENDOR_LIBRARY_FILENAMES,/usr/share/glvnd/egl_vendor.d/10_nvidia.json
env = MOZ_DISABLE_RDD_SANDBOX,1
#env = MOZ_DISABLE_SANDBOX,1  Not doing this for now

#Kitty Stuff
env = ENABLE_VKBASALT,1
env = KITTY_ENABLE_WAYLAND,1

#Qt stuff
env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = QT_QplA_PLATFORM,wayland;xcb
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1

env = WLR_DRM_NO_ATOMIC,0
#env = GDK_SCALE,1.25

###################
###  Variables  ###
###################
$terminal = wezterm 
$fileManager = thunar 
$menu = rofi -show drun -show-icons
$browser = firefox
$activeOpacity = 0.97 #0.97
$inactiveOpacity = 0.95 #0.95
$primary = rgb(FFFFFF)
$mainMod = SUPER

#################
### AUTOSTART ###
#################
exec-once = hyprpm reload -n
exec-once = ~/.config/hypr/portal.sh &
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = hyprctl setcursor rose-pine-hyprcursor 38
exec-once = swaync
exec-once = waybar
exec-once = swww-daemon
#exec-once = systemctl --user start otd-daemon
exec-once = systemctl --user start hyprpolkitagent #Manually start it so we don't run this on non hyprland wms
exec-once = wl-paste --watch cliphist store


#####################
### LOOK AND FEEL ###
#####################
#source = ~/.cache/wal/colors-hyprland.conf
xwayland {
    force_zero_scaling = true
}

#device {
#    name = opentabletdriver-virtual-artist-tablet
#}

cursor {
    no_break_fs_vrr = true
}

general { 
    gaps_in = 4
    gaps_out = 4
    border_size=3
    col.active_border = rgb(c9b9c6) #$color11 #$background $background $color14
    col.inactive_border = rgb(000000) #rgb(c9b9c6) #$color14 #$background
    resize_on_border = false 
    allow_tearing = true
    layout = dwindle
}

decoration {
    rounding = 2
    active_opacity = $activeOpacity
    inactive_opacity = $inactiveOpacity
    fullscreen_opacity = 1.0
    #col.shadow = rgba(1a1a1aee)
    
    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1
        vibrancy = 0.1696
    }
}

animations {
    enabled = false
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

dwindle {
    pseudotile = true
    preserve_split = true
}



misc { 
    force_default_wallpaper = -1
    disable_hyprland_logo = false 
    enable_swallow = true 
    swallow_regex=^(kitty|com.mitchellh.ghostty|org.wezfurlong.wezterm)$
    middle_click_paste = false
}

#############
### INPUT ###
#############
input {
    kb_layout = us,ru,pl
    kb_variant =
    kb_model =
    kb_options = grp:alt_shift_toggle
    kb_rules =

    follow_mouse = 0

    sensitivity = 0
    accel_profile=flat
    force_no_accel=1

    touchpad {
        natural_scroll = false
    }
}

gestures {
    workspace_swipe = false
}

plugin {
    split-monitor-workspaces {
        count = 5
        keep_focused = 1
        enable_notifications = 1
        enable_persistent_workspaces = 1
    }

    hyprbars {
        bar_height = 20
        bar_color = 0xff000000
        bar_text_size = 18
    }
}

####################
### KEYBINDINGSS ###
####################
bind = $mainMod, Return, exec, $terminal
bind = $mainMod, E, exec, $fileManager
bind = $mainMod, R, exec, $menu
bind = $mainMod, W, exec, $browser 
bind = $mainMod, code:51, exec, 1password --ozone-platform=x11

bind = $mainMod shift, w, exec, sh ~/.config/rofi/scripts/wallpaper.sh
bind = $mainMod shift, s, exec, hyprshot -m region 
bind = $mainMod shift, e, exec, pkill waybar && hyprctl dispatch exec waybar
bind = $mainMod, F10, pass, class:^(com\.obsproject\.Studio)$

bind = $mainMod, Q, killactive,
bind = $mainMod, M, exit,
bind = $mainMod, V, togglefloating,
bind = $mainMod, F, fullscreen,
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

bind = $mainMod, H, movefocus, l
bind = $mainMod, L, movefocus, r
bind = $mainMod, J, movefocus, u
bind = $mainMod, K, movefocus, d

bind = $mainMod shift, H, movewindow, l
bind = $mainMod shift, L, movewindow, r
bind = $mainMod shift, J, movewindow, u
bind = $mainMod shift, K, movewindow, d

bind = $mainMod, 1, split-workspace, 1
bind = $mainMod, 2, split-workspace, 2
bind = $mainMod, 3, split-workspace, 3
bind = $mainMod, 4, split-workspace, 4
bind = $mainMod, 5, split-workspace, 5

bind = $mainMod SHIFT, 1, split-movetoworkspace, 1
bind = $mainMod SHIFT, 2, split-movetoworkspace, 2
bind = $mainMod SHIFT, 3, split-movetoworkspace, 3
bind = $mainMod SHIFT, 4, split-movetoworkspace, 4
bind = $mainMod SHIFT, 5, split-movetoworkspace, 5

bind = $mainMod SHIFT, P, split-changemonitor, 1

##############################
### WINDOWS AND WORKSPACES ###
##############################

#You'll probably like this?
windowrulev2 = suppressevent maximize, class:.* 

#Hearthstone Overlay stuff
windowrulev2 = tag +poe, title:(Hearthstone)
windowrulev2 = float, tag:hs

windowrulev2 = tag +apt, title:(HearthstoneOverlay)
windowrulev2 = float, tag:apt 
windowrulev2 = noblur, tag:apt
windowrulev2 = nofocus, tag:apt # Disable auto-focus
windowrulev2 = noshadow, tag:apt
windowrulev2 = noborder, tag:apt
windowrulev2 = size 100% 100%, tag:apt
windowrulev2 = center, tag:apt

# Float rules for file dialogs and utility windows
windowrulev2 = float,class:^(.*)$,title:^(Open File)(.*)$
windowrulev2 = float,class:^(.*)$,title:^(Select a File)(.*)$
windowrulev2 = float,class:^(.*)$,title:^(Choose wallpaper)(.*)$
windowrulev2 = float,class:^(.*)$,title:^(Open Folder)(.*)$
windowrulev2 = float,class:^(.*)$,title:^(Save As)(.*)$
windowrulev2 = float,class:^(.*)$,title:^(Library)(.*)$

# Firefox rules
windowrulev2 = opacity 1 override $inactiveOpacity override,class:^(firefox)$
windowrulev2 = noblur,class:^(firefox)$

# Float rules for common apps
windowrulev2 = float,class:^(steam_app_.*)$
windowrulev2 = float,class:^(steam_proton)$
windowrulev2 = float,class:^(steam)$
windowrulev2 = float,class:^(nm-connection-editor)$
windowrulev2 = float,class:^(pavucontrol)$
windowrulev2 = float,class:^(blueman-manager)$

#Osu Rule
windowrulev2 = immediate, class:^(osu!.exe)$
#Wuthering Waves



#windowrulev2 = opacity 0.90 0.90,class:^(steam_app_3513350)$,title:^(.*Popup.*)$
#windowrulev2 = noblur,class:^(steam_app_3513350)$,floating:1
#windowrulev2 = rounding 10,class:^(steam_app_3513350)$,floating:1

#windowrulev2 = opacity 0.5 ,class:^(steam_app_3513350)$,floating:1
#windowrulev2 = bordercolor rgba(ff0000ff),class:^(steam_app_3513350)$,floating:1,title:^$
